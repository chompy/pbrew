redis: |
  if [ ! -f {DATA_PATH}/redis.so ]; then
    cd /tmp
    curl -o /tmp/ext.tar.gz https://pecl.php.net/get/redis-5.3.4.tgz
    tar xvfz ext.tar.gz
    rm /tmp/ext.tar.gz
    cd /tmp/redis-*
    phpize
    ./configure
    make
    cp modules/redis.so {DATA_PATH}/redis.so
    rm -rf /tmp/redis-*
  fi

igbinary: |
  if [ ! -f {DATA_PATH}/igbinary.so ]; then
    cd /tmp
    curl -o /tmp/ext.tar.gz https://pecl.php.net/get/igbinary-3.2.6.tgz
    tar xvfz ext.tar.gz
    rm /tmp/ext.tar.gz
    cd /tmp/igbinary-*
    phpize
    ./configure
    make
    cp modules/igbinary.so {DATA_PATH}/igbinary.so
    rm -rf /tmp/igbinary-*
  fi

imagick: |
  if [ ! -f {DATA_PATH}/imagick.so ]; then
    if [ ! -d $HOME/imagick ]; then
      cd /tmp
      curl -L -o /tmp/im.tar.gz https://github.com/ImageMagick/ImageMagick/archive/refs/tags/7.1.0-8.tar.gz
      tar xvfz im.tar.gz
      rm im.tar.gz
      cd /tmp/ImageMagick-7.1.0-8
      mkdir $HOME/imagick
      ./configure --prefix $HOME/imagick
      make
      make install
      rm -rf /tmp/ImageMagick-7.1.0-8
    fi
    cd /tmp
    curl -o /tmp/ext.tar.gz https://pecl.php.net/get/imagick-3.5.1.tgz
    tar xvfz ext.tar.gz
    rm /tmp/ext.tar.gz
    cd /tmp/imagick-*
    phpize
    ./configure --with-imagick=$HOME/imagick
    make
    cp modules/imagick.so {DATA_PATH}/imagick.so
    rm -rf /tmp/imagick-*
  fi

#igbinary: |
#  if [ ! -f {BREW_PATH}/lib/php/pecl/*/igbinary.so ]; then
#    {BREW_PATH}/opt/{BREW_APP}/bin/pecl install igbinary
#  fi

#imagick: |
#  if [ ! -f {BREW_PATH}/lib/php/extensions/imagick.so ]; then
#    {BREW_PATH}/bin/brew install imagemagick --force-bottle
#    {BREW_PATH}/opt/{BREW_APP}/bin/pecl install imagick
#  fi
